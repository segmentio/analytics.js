<!DOCTYPE html>  <html> <head>   <title>analytics.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="analytics.html">                 analytics.js               </a>                                           <a class="source" href="chartbeat.html">                 chartbeat.js               </a>                                           <a class="source" href="clicky.html">                 clicky.js               </a>                                           <a class="source" href="comscore.html">                 comscore.js               </a>                                           <a class="source" href="crazyegg.html">                 crazyegg.js               </a>                                           <a class="source" href="customerio.html">                 customerio.js               </a>                                           <a class="source" href="errorception.html">                 errorception.js               </a>                                           <a class="source" href="ga.html">                 ga.js               </a>                                           <a class="source" href="gauges.html">                 gauges.js               </a>                                           <a class="source" href="gosquared.html">                 gosquared.js               </a>                                           <a class="source" href="hittail.html">                 hittail.js               </a>                                           <a class="source" href="hubspot.html">                 hubspot.js               </a>                                           <a class="source" href="intercom.html">                 intercom.js               </a>                                           <a class="source" href="kissmetrics.html">                 kissmetrics.js               </a>                                           <a class="source" href="klaviyo.html">                 klaviyo.js               </a>                                           <a class="source" href="mixpanel.html">                 mixpanel.js               </a>                                           <a class="source" href="olark.html">                 olark.js               </a>                                           <a class="source" href="quantcast.html">                 quantcast.js               </a>                                           <a class="source" href="snapengage.html">                 snapengage.js               </a>                                           <a class="source" href="usercycle.html">                 usercycle.js               </a>                                           <a class="source" href="vero.html">                 vero.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               analytics.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <pre><code>Analytics.js 0.3.6
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <pre><code>(c) 2013 Segment.io Inc.
Analytics.js may be freely distributed under the MIT license.
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>Setup</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>The <code>analytics</code> object that will be exposed to you on the global object.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">analytics</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Cache the <code>userId</code> when a user is identified.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">userId</span> <span class="o">:</span> <span class="kc">null</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Store the date when the page loaded, for services that depend on it.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">date</span> <span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Store window.onload state so that analytics that rely on it can be loaded
even after onload fires.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">loaded</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Whether analytics.js has been initialized with providers.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialized</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>The amount of milliseconds to wait for requests to providers to clear
before navigating away from the current page.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">timeout</span> <span class="o">:</span> <span class="mi">250</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h2>Providers</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>A dictionary of analytics providers that <em>can</em> be initialized.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initializableProviders</span> <span class="o">:</span> <span class="p">{},</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>An array of analytics providers that are initialized.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">providers</span> <span class="o">:</span> <span class="p">[],</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Adds a provider to the list of available providers that can be
initialized.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">addProvider</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">provider</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">initializableProviders</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">provider</span><span class="p">;</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h2>Initialize</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Call <strong>initialize</strong> to setup analytics.js before identifying or
tracking any users or events. Here's what a call to <strong>initialize</strong>
might look like:</p>

<pre><code>analytics.initialize({
    'Google Analytics' : 'UA-XXXXXXX-X',
    'Segment.io'       : 'XXXXXXXXXXX',
    'KISSmetrics'      : 'XXXXXXXXXXX'
});
</code></pre>

<ul>
<li><code>providers</code> is a dictionary of the providers you want to enabled.
The keys are the names of the providers and their values are either
an api key, or dictionary of extra settings (including the api key).</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialize</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">providers</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Reset our state.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">this</span><span class="p">.</span><span class="nx">providers</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">userId</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Initialize each provider with the proper settings, and copy the
provider into <code>this.providers</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">providers</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">initializableProviders</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">settings</span> <span class="o">=</span> <span class="nx">providers</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">provider</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Could not find a provider named &quot;&#39;</span><span class="o">+</span><span class="nx">key</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
                <span class="nx">provider</span><span class="p">.</span><span class="nx">initialize</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">provider</span><span class="p">);</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Update the initialized state that other methods rely on.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">this</span><span class="p">.</span><span class="nx">initialized</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Try to use id and event parameters from the url</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">userId</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getUrlParameter</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">,</span> <span class="s1">&#39;ajs_uid&#39;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">userId</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">identify</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getUrlParameter</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">,</span> <span class="s1">&#39;ajs_event&#39;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <h2>Identify</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Identifying a user ties all of their actions to an ID you recognize
and records properties about a user. An example identify:</p>

<pre><code>analytics.identify('4d3ed089fb60ab534684b7e0', {
    name  : 'Achilles',
    email : 'achilles@segment.io',
    age   : 23
});
</code></pre>

<ul>
<li><p><code>userId</code> (optional) is the ID you know the user by. Ideally this
isn't an email, because the user might be able to change their email
and you don't want that to affect your analytics.</p></li>
<li><p><code>traits</code> (optional) is a dictionary of traits to tie your user.
Things like <code>name</code>, <code>age</code> or <code>friendCount</code>. If you have them, you
should always store a <code>name</code> and <code>email</code>.</p></li>
<li><p><code>callback</code> (optional) is a function to call after the a small
timeout to give the identify requests a chance to be sent.</p></li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">identify</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">traits</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">initialized</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Allow for not passing traits, but passing a callback.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">traits</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">callback</span> <span class="o">=</span> <span class="nx">traits</span><span class="p">;</span>
                <span class="nx">traits</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Allow for identifying traits without setting a <code>userId</code>, for
anonymous users whose traits you learn.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">userId</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">traits</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">traits</span><span class="p">))</span> <span class="nx">callback</span> <span class="o">=</span> <span class="nx">traits</span><span class="p">;</span>
                <span class="nx">traits</span> <span class="o">=</span> <span class="nx">userId</span><span class="p">;</span>
                <span class="nx">userId</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Cache the <code>userId</code>, or use saved one.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="nx">userId</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">userId</span> <span class="o">=</span> <span class="nx">userId</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="nx">userId</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">userId</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Call <code>identify</code> on all of our enabled providers that support it.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">provider</span><span class="p">;</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">provider</span><span class="p">.</span><span class="nx">identify</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="nx">provider</span><span class="p">.</span><span class="nx">identify</span><span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">traits</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">callback</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">timeout</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <h2>Track</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Whenever a visitor triggers an event on your site that you're
interested in, you'll want to track it. An example track:</p>

<pre><code>analytics.track('Added a Friend', {
    level  : 'hard',
    volume : 11
});
</code></pre>

<ul>
<li><p><code>event</code> is the name of the event. The best names are human-readable
so that your whole team knows what they mean when they analyze your
data.</p></li>
<li><p><code>properties</code> (optional) is a dictionary of properties of the event.
Property keys are all camelCase (we'll alias to non-camelCase for
you automatically for providers that require it).</p></li>
<li><p><code>callback</code> (optional) is a function to call after the a small
timeout to give the track requests a chance to be sent.</p></li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">track</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">initialized</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Allow for not passing properties, but passing a callback.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">properties</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">callback</span> <span class="o">=</span> <span class="nx">properties</span><span class="p">;</span>
                <span class="nx">properties</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Call <code>track</code> on all of our enabled providers that support it.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">provider</span><span class="p">;</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">provider</span><span class="p">.</span><span class="nx">track</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="nx">provider</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">properties</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">callback</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">timeout</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <h3>trackClick</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>A helper for tracking outbound links that would normally leave the
page before the track calls went out. It works by wrapping the calls
in as short of a timeout as possible to fire the track call, because
<a href="http://theixdlibrary.com/pdf/Miller1968.pdf">response times matter</a>.</p>

<ul>
<li><p><code>element</code> is either a single DOM element, or an array of DOM
elements like jQuery gives you.</p></li>
<li><p><code>event</code> and <code>properties</code> are passed directly to <code>analytics.track</code>
and take the same options.</p></li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">trackClick</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">element</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Turn a single element into an array so that we're always handling
arrays, which allows for passing jQuery objects.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">element</span><span class="p">))</span> <span class="nx">element</span> <span class="o">=</span> <span class="p">[</span><span class="nx">element</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Bind to all the elements in the array.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">element</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">element</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

                <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>Fire a normal track call.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nx">self</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>To justify us preventing the default behavior we must:</p>

<ul>
<li>Have an <code>href</code> to use.</li>
<li>Not have a <code>target="_blank"</code> attribute.</li>
<li>Not have any special keys pressed, because they might
be trying to open in a new tab, or window, or download
the asset.</li>
</ul>

<p>This might not cover all cases, but we'd rather throw out
an event than miss a case that breaks the experience.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="k">if</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">href</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">target</span> <span class="o">!==</span> <span class="s1">&#39;_blank&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">self</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isMeta</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Prevent the link's default redirect in all the sane
browsers, and also IE.</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">)</span>
                            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
                        <span class="k">else</span>
                            <span class="nx">e</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Navigate to the url after a small timeout, giving the
providers time to track the event.</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                            <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
                        <span class="p">},</span> <span class="nx">self</span><span class="p">.</span><span class="nx">timeout</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <h3>trackSubmit</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Similar to <code>trackClick</code>, this is a helper for tracking form
submissions that would normally leave the page before a track call
can be sent. It works by preventing the default submit, sending a
track call, and then submitting the form programmatically.</p>

<ul>
<li><p><code>form</code> is either a single form element, or an array of
form elements like jQuery gives you.</p></li>
<li><p><code>event</code> and <code>properties</code> are passed directly to <code>analytics.track</code>
and take the same options.</p></li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">trackSubmit</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">form</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">form</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Turn a single element into an array so that we're always handling
arrays, which allows for passing jQuery objects.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">form</span><span class="p">))</span> <span class="nx">form</span> <span class="o">=</span> <span class="p">[</span><span class="nx">form</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Bind to all the forms in the array.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">form</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">form</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

                <span class="k">this</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="s1">&#39;submit&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Fire a normal track call.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nx">self</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Prevent the form's default submit in all the sane
browsers, and also IE.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">)</span>
                        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
                    <span class="k">else</span>
                        <span class="nx">e</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>Submit the form after a small timeout, giving the event
time to get fired.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                        <span class="nx">el</span><span class="p">.</span><span class="nx">submit</span><span class="p">();</span>
                    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">timeout</span><span class="p">);</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <h2>Pageview</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>For single-page applications where real page loads don't happen, the
<strong>pageview</strong> method simulates a page loading event for all providers
that track pageviews and support it. This is the equivalent of
calling <code>_gaq.push(['trackPageview'])</code> in Google Analytics.</p>

<p><strong>pageview</strong> is <em>not</em> for sending events about which pages in your
app the user has loaded. For that, use a regular track call like:
<code>analytics.track('View Signup Page')</code>. Or, if you think you've come
up with a badass abstraction, submit a pull request!</p>

<ul>
<li><code>url</code> (optional) is the url path that you want to be associated
with the page. You only need to pass this argument if the URL hasn't
changed but you want to register a new pageview.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">pageview</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">initialized</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>Call <code>pageview</code> on all of our enabled providers that support it.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">provider</span><span class="p">;</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">provider</span><span class="p">.</span><span class="nx">pageview</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="nx">provider</span><span class="p">.</span><span class="nx">pageview</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <h2>Utils</h2>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">utils</span> <span class="o">:</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Attach an event handler to a DOM element, even in IE.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">bind</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">el</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>Given a DOM event, tell us whether a meta key or button was
pressed that would make a link open in a new tab, window,
start a download, or anything else that wouldn't take the user to
a new page.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">isMeta</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">metaKey</span> <span class="o">||</span> <span class="nx">e</span><span class="p">.</span><span class="nx">altKey</span> <span class="o">||</span> <span class="nx">e</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>Logic that handles checks for the middle mouse button, based
on <a href="https://github.com/jquery/jquery/blob/master/src/event.js#L466">jQuery</a>.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="kd">var</span> <span class="nx">which</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span><span class="p">,</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">button</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">which</span> <span class="o">&amp;&amp;</span> <span class="nx">button</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="p">(</span><span class="o">!</span><span class="nx">button</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">button</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">button</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">which</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>Given a timestamp, return its value in seconds. For providers
that rely on Unix time instead of millis.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">getSeconds</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">time</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">time</span><span class="p">))</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">);</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>A helper to extend objects with properties from other objects.
Based off of the <a href="https://github.com/documentcloud/underscore/blob/master/underscore.js#L763">underscore</a>
method.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">extend</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">source</span><span class="p">;</span> <span class="nx">source</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">property</span> <span class="k">in</span> <span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">obj</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span> <span class="o">=</span> <span class="nx">source</span><span class="p">[</span><span class="nx">property</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>A helper to shallow-ly clone objects, so that they don't get
mangled by different analytics providers because of the
reference.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">clone</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">obj</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">obj</span><span class="p">);</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>A helper to alias certain object's keys to different key names.
Useful for abstracting over providers that require specific key
names.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">alias</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">aliases</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">aliases</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">alias</span> <span class="o">=</span> <span class="nx">aliases</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">obj</span><span class="p">[</span><span class="nx">alias</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
                        <span class="k">delete</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Type detection helpers, copied from
<a href="https://github.com/documentcloud/underscore/blob/master/underscore.js#L926-L946">underscore</a>.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">isElement</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">isArray</span> <span class="o">:</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object Array]&#39;</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">isObject</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">obj</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">isString</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object String]&#39;</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">isFunction</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object Function]&#39;</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">isNumber</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object Number]&#39;</span><span class="p">;</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>Email detection helper to loosely validate emails.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">isEmail</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">(</span><span class="sr">/.+\@.+\..+/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">string</span><span class="p">);</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>A helper to resolve a settings object. It allows for <code>settings</code>
to be a string in the case of using the shorthand where just an
api key is passed. <code>fieldName</code> is what the provider calls their
api key.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">resolveSettings</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">settings</span><span class="p">))</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Could not resolve settings.&#39;</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fieldName</span><span class="p">)</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;You must provide an api key field name.&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>Allow for settings to just be an API key, for example:</p>

<pre><code>{ 'Google Analytics : 'UA-XXXXXXX-X' }
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">settings</span><span class="p">))</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">;</span>
                    <span class="nx">settings</span> <span class="o">=</span> <span class="p">{};</span>
                    <span class="nx">settings</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">apiKey</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">return</span> <span class="nx">settings</span><span class="p">;</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>A helper to track events based on the 'anjs' url parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">getUrlParameter</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">urlSearchParameter</span><span class="p">,</span> <span class="nx">paramKey</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="nx">urlSearchParameter</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">params</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">param</span> <span class="o">=</span> <span class="nx">params</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">param</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">param</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">paramKey</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">param</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Wrap any existing <code>onload</code> function with our own that will cache the
loaded state of the page.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">oldonload</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span><span class="p">;</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">analytics</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">oldonload</span><span class="p">))</span> <span class="nx">oldonload</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span> <span class="o">=</span> <span class="nx">analytics</span><span class="p">;</span>
<span class="p">})();</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 