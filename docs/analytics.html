<!DOCTYPE html>  <html> <head>   <title>analytics.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               analytics.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>A reference to the global object.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>A list of available providers that <em>can</em> be initialized by you.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">availableProviders</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Whether analytics.js has been initialized.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">initialized</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>A helper to shallow-ly clone objects, so that they don't get mangled or
added to by different analytics providers because of the reference.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">obj</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="nx">clone</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
        <span class="k">return</span> <span class="nx">clone</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">isString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object String]&#39;</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">isObject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">obj</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>A helper to resolve a settings object. It allows for <code>settings</code> to be an
<code>apiKey</code> string in the case of no additional settings being needed.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">resolveSettings</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isString</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">settings</span><span class="p">))</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Encountered unresolvable settings value.&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">isString</span><span class="p">(</span><span class="nx">settings</span><span class="p">))</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">;</span>
            <span class="nx">settings</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="nx">settings</span><span class="p">.</span><span class="nx">apiKey</span> <span class="o">=</span> <span class="nx">apiKey</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">settings</span><span class="p">;</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>The <code>analytics</code> object that will be exposed to you on the global object.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">root</span><span class="p">.</span><span class="nx">analytics</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>A list of providers that have been initialized.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">providers</span> <span class="o">:</span> <span class="p">[],</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h1>Initialize</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Call <strong>initialize</strong> to setup analytics.js before identifying or
tracking any users or events. It takes a list of providers that you
want to enable, along with settings for each provider. (Settings vary
depending on the provider.) Here's what a call to <strong>initialize</strong>
might look like:</p>

<pre><code>analytics.initialize({
    'Google Analytics' : {
        apiKey : 'UA-XXXXXXX-X'
    },
    'Segment.io' : {
        apiKey : 'XXXXXXXXXXX'
    },
    'KISSmetrics' : {
        apiKey : 'XXXXXXXXXXX'
    },
    Mixpanel : {
        apiKey : 'XXXXXXXXXXX',
        people : true
    }
});
</code></pre>

<p><code>providers</code> - a dictionary of the providers you want to enabled. The
keys are the names of the providers and their values are the settings
they get passed on initialization.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialize</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">providers</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">initializedProviders</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">providers</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">availableProviders</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Couldn\&#39;t find a provider named &quot;&#39;</span><span class="o">+</span><span class="nx">key</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
                <span class="nx">availableProviders</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">initialize</span><span class="p">(</span><span class="nx">providers</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
                <span class="nx">initializedProviders</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">availableProviders</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">providers</span> <span class="o">=</span> <span class="nx">initializedProviders</span><span class="p">;</span>

            <span class="nx">initialized</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <h1>Identify</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Identifying a user ties all of their actions to an ID you recognize
and records properties about a user. An example identify:</p>

<pre><code>analytics.identify('user@example.com', {
    name : 'Achilles',
    age  : 23
});
</code></pre>

<p><code>userId</code> - the ID you recognize your user by, like an email.</p>

<p><code>traits</code> - an optional dictionary of traits to tie your user. Things
like <em>Name</em>, <em>Age</em> or <em>Friend Count</em>.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">identify</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">traits</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">initialized</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">provider</span><span class="p">;</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">provider</span><span class="p">.</span><span class="nx">identify</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">clonedTraits</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">traits</span><span class="p">);</span>
                <span class="nx">provider</span><span class="p">.</span><span class="nx">identify</span><span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">clonedTraits</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <h1>Track</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Whenever a visitor triggers an event on your site that you're
interested in, you'll want to track it. An example track:</p>

<pre><code>analytics.track('Added a Friend', {
    level  : 'hard',
    volume : 11
});
</code></pre>

<p><code>event</code> - the name of the event. The best event names are human-
readable so that your whole team knows what they are when you analyze
your data.</p>

<p><code>properties</code> - an optional dictionary of properties of the event.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">track</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">initialized</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">provider</span><span class="p">;</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">provider</span><span class="p">.</span><span class="nx">track</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">clonedProperties</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">properties</span><span class="p">);</span>
                <span class="nx">provider</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">clonedProperties</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <h1>Providers</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h2>Google Analytics</h2>

<p><em>Last updated: September 27th, 2012</em></p>

<p>https://developers.google.com/analytics/devguides/collection/gajs/</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">availableProviders</span><span class="p">[</span><span class="s1">&#39;Google Analytics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Changes to the Google Analytics snippet:</p>

<ul>
<li>Add <code>apiKey</code> to call to <code>_setAccount</code>.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialize</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="nx">resolveSettings</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>

            <span class="kd">var</span> <span class="nx">_gaq</span> <span class="o">=</span> <span class="nx">_gaq</span> <span class="o">||</span> <span class="p">[];</span>
            <span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;_setAccount&#39;</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">]);</span>
            <span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;_trackPageview&#39;</span><span class="p">]);</span>

            <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">ga</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span> <span class="nx">ga</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span> <span class="nx">ga</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="nx">ga</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;https:&#39;</span> <span class="o">==</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">?</span> <span class="s1">&#39;https://ssl&#39;</span> <span class="o">:</span> <span class="s1">&#39;http://www&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.google-analytics.com/ga.js&#39;</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="nx">s</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">ga</span><span class="p">,</span> <span class="nx">s</span><span class="p">);</span>
            <span class="p">})();</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">_gaq</span> <span class="o">=</span> <span class="nx">_gaq</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">track</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;_trackEvent&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="nx">event</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <h2>Segment.io</h2>

<p><em>Last updated: September 27th, 2012</em></p>

<p>https://segment.io/docs/javascript-api</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">availableProviders</span><span class="p">[</span><span class="s1">&#39;Segment.io&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Changes to the Segemnt.io snippet:</p>

<ul>
<li>Add <code>apiKey</code> and <code>settings</code> args to call to <code>initialize</code>.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialize</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="nx">resolveSettings</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>

            <span class="kd">var</span> <span class="nx">segment</span><span class="o">=</span><span class="nx">segment</span><span class="o">||</span><span class="p">[];</span><span class="nx">segment</span><span class="p">.</span><span class="nx">load</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">);</span><span class="nx">b</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">async</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span><span class="nx">a</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">);</span><span class="nx">b</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="nx">segment</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">a</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">)))}};</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;init initialize identify track callback logLevel verbose&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="nx">segment</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span><span class="o">=</span><span class="nx">b</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">])};</span><span class="nx">segment</span><span class="p">.</span><span class="nx">load</span><span class="p">((</span><span class="s2">&quot;https:&quot;</span><span class="o">===</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span><span class="o">?</span><span class="s2">&quot;https://&quot;</span><span class="o">:</span><span class="s2">&quot;http://&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;d47xnnr8b1rki.cloudfront.net/api/js/v2/segmentio.js&quot;</span><span class="p">);</span>
            <span class="nx">segment</span><span class="p">.</span><span class="nx">initialize</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">segment</span> <span class="o">=</span> <span class="nx">segment</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">identify</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">traits</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">segment</span><span class="p">.</span><span class="nx">identify</span><span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">traits</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">track</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">segment</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <h2>KISSmetrics</h2>

<p><em>Last updated: September 27th, 2012</em></p>

<p>http://support.kissmetrics.com/apis/javascript</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">availableProviders</span><span class="p">[</span><span class="s1">&#39;KISSmetrics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Changes to the KISSmetrics snippet:</p>

<ul>
<li>Concatenate in the <code>apiKey</code>.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialize</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="nx">resolveSettings</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>

            <span class="kd">var</span> <span class="nx">_kmq</span> <span class="o">=</span> <span class="nx">_kmq</span> <span class="o">||</span> <span class="p">[];</span>
            <span class="kd">function</span> <span class="nx">_kms</span><span class="p">(</span><span class="nx">u</span><span class="p">){</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                    <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nb">document</span><span class="p">,</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="nx">s</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
                    <span class="nx">s</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">u</span><span class="p">;</span>
                    <span class="nx">f</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">f</span><span class="p">);</span>
                <span class="p">},</span> <span class="mi">1</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">_kms</span><span class="p">(</span><span class="s1">&#39;//i.kissmetrics.com/i.js&#39;</span><span class="p">);</span>
            <span class="nx">_kms</span><span class="p">(</span><span class="s1">&#39;//doug1izaerwt3.cloudfront.net/&#39;</span><span class="o">+</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">apiKey</span> <span class="o">+</span><span class="s1">&#39;.1.js&#39;</span><span class="p">);</span> <span class="c1">// Add API key from settings.</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">_kmq</span> <span class="o">=</span> <span class="nx">_kmq</span><span class="p">;</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>KISSmetrics uses two separate methods: <code>identify</code> for storing the
<code>userId</code> and <code>set</code> for storing <code>traits</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">identify</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">traits</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">_kmq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;identify&#39;</span><span class="p">,</span> <span class="nx">userId</span><span class="p">]);</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">_kmq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;set&#39;</span><span class="p">,</span> <span class="nx">traits</span><span class="p">]);</span>
        <span class="p">},</span>

        <span class="nx">track</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">_kmq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;record&#39;</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <h2>Mixpanel</h2>

<p><em>Last updated: September 27th, 2012</em></p>

<p>https://mixpanel.com/docs/integration-libraries/javascript
https://mixpanel.com/docs/people-analytics/javascript
https://mixpanel.com/docs/integration-libraries/javascript-full-api</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">availableProviders</span><span class="p">[</span><span class="s1">&#39;Mixpanel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Changes to the Mixpanel snippet:</p>

<ul>
<li>Use window for call to <code>init</code>.</li>
<li>Add <code>apiKey</code> and <code>settings</code> args to call to <code>init</code>.</li>
</ul>

<p>Also, we don't need to set the <code>mixpanel</code> object on <code>window</code> because
they already do that.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialize</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="nx">resolveSettings</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>

            <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">a</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span><span class="kd">var</span> <span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">e</span><span class="p">;</span><span class="nx">b</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">);</span>
            <span class="nx">b</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">async</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;https:&quot;</span><span class="o">===</span><span class="nx">c</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span><span class="o">?</span><span class="s2">&quot;https:&quot;</span><span class="o">:</span><span class="s2">&quot;http:&quot;</span><span class="p">)</span><span class="o">+</span>
            <span class="s1">&#39;//cdn.mxpnl.com/libs/mixpanel-2.1.min.js&#39;</span><span class="p">;</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nx">d</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">_i</span><span class="o">=</span><span class="p">[];</span><span class="nx">a</span><span class="p">.</span><span class="nx">init</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">f</span><span class="p">){</span><span class="kd">function</span> <span class="nx">d</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span>
            <span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span><span class="mi">2</span><span class="o">==</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span><span class="nx">b</span><span class="o">=</span><span class="nx">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">b</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span>
            <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">)))}}</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span><span class="s2">&quot;undefined&quot;</span><span class="o">!==</span><span class="k">typeof</span> <span class="nx">f</span><span class="o">?</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span><span class="o">:</span>
            <span class="nx">f</span><span class="o">=</span><span class="s2">&quot;mixpanel&quot;</span><span class="p">;</span><span class="nx">g</span><span class="p">.</span><span class="nx">people</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">people</span><span class="o">||</span><span class="p">[];</span><span class="nx">h</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;disable&#39;</span><span class="p">,</span><span class="s1">&#39;track&#39;</span><span class="p">,</span><span class="s1">&#39;track_pageview&#39;</span><span class="p">,</span><span class="s1">&#39;track_links&#39;</span><span class="p">,</span>
            <span class="s1">&#39;track_forms&#39;</span><span class="p">,</span><span class="s1">&#39;register&#39;</span><span class="p">,</span><span class="s1">&#39;register_once&#39;</span><span class="p">,</span><span class="s1">&#39;unregister&#39;</span><span class="p">,</span><span class="s1">&#39;identify&#39;</span><span class="p">,</span><span class="s1">&#39;name_tag&#39;</span><span class="p">,</span>
            <span class="s1">&#39;set_config&#39;</span><span class="p">,</span><span class="s1">&#39;people.identify&#39;</span><span class="p">,</span><span class="s1">&#39;people.set&#39;</span><span class="p">,</span><span class="s1">&#39;people.increment&#39;</span><span class="p">];</span><span class="k">for</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">e</span><span class="o">++</span><span class="p">)</span><span class="nx">d</span><span class="p">(</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">[</span><span class="nx">e</span><span class="p">]);</span>
            <span class="nx">a</span><span class="p">.</span><span class="nx">_i</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">f</span><span class="p">])};</span><span class="nx">a</span><span class="p">.</span><span class="nx">__SV</span><span class="o">=</span><span class="mf">1.1</span><span class="p">;})(</span><span class="nb">document</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="o">||</span><span class="p">[]);</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Only identify with Mixpanel's People feature if you opt-in because
otherwise Mixpanel charges you for it.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">identify</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">traits</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="p">.</span><span class="nx">identify</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="p">.</span><span class="nx">name_tag</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="nx">traits</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">people</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="p">.</span><span class="nx">people</span><span class="p">.</span><span class="nx">identify</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="p">.</span><span class="nx">people</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">traits</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">track</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">mixpanel</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <h2>Intercom</h2>

<p><em>Last updated: September 27th, 2012</em></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">availableProviders</span><span class="p">[</span><span class="s1">&#39;Intercom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Intercom identifies when the script is loaded, so instead of
initializing in <code>initialize</code>, we have to initialize in <code>identify</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="nx">resolveSettings</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Changes to the Intercom snippet:</p>

<ul>
<li>Add <code>apiKey</code> from stored <code>settings</code>.</li>
<li>Add <code>userId</code>.</li>
<li>Add a unix timestamp.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">identify</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">traits</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">intercomSettings</span> <span class="o">=</span> <span class="p">{</span>
                <span class="nx">app_id</span>     <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">,</span>
                <span class="nx">email</span>      <span class="o">:</span> <span class="nx">userId</span><span class="p">,</span>
                <span class="nx">created_at</span> <span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="p">};</span>
            <span class="kd">function</span> <span class="nx">async_load</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">&#39;https://api.intercom.io/api/js/library.js&#39;</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
                <span class="nx">x</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">&#39;onload&#39;</span><span class="p">,</span> <span class="nx">async_load</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="nx">async_load</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <h2>Olark</h2>

<p><em>Last updated: October 11th, 2012</em></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">availableProviders</span><span class="p">[</span><span class="s1">&#39;Olark&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Changes to the Olark snippet:</p>

<ul>
<li>Removed <code>CDATA</code> tags.</li>
<li>Add <code>apiKey</code> from stored <code>settings</code>.</li>
<li>Added <code>window.</code> before <code>olark.identify</code>.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">initialize</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="nx">resolveSettings</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">olark</span><span class="o">||</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="nb">window</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nb">document</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span><span class="o">==</span><span class="s2">&quot;https:&quot;</span><span class="o">?</span><span class="s2">&quot;https:&quot;</span><span class="o">:</span><span class="s2">&quot;http:&quot;</span><span class="p">,</span><span class="nx">z</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="s2">&quot;load&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">nt</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">[</span><span class="nx">z</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){(</span><span class="nx">a</span><span class="p">.</span><span class="nx">s</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">s</span><span class="o">||</span><span class="p">[]).</span><span class="nx">push</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)};</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">[</span><span class="nx">z</span><span class="p">].</span><span class="nx">_</span><span class="o">=</span><span class="p">{},</span><span class="nx">q</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">methods</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">q</span><span class="o">--</span><span class="p">){(</span><span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span><span class="nx">f</span><span class="p">[</span><span class="nx">z</span><span class="p">][</span><span class="nx">n</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">[</span><span class="nx">z</span><span class="p">](</span><span class="s2">&quot;call&quot;</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)}})(</span><span class="nx">c</span><span class="p">.</span><span class="nx">methods</span><span class="p">[</span><span class="nx">q</span><span class="p">])}</span><span class="nx">a</span><span class="p">.</span><span class="nx">l</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">loader</span><span class="p">;</span><span class="nx">a</span><span class="p">.</span><span class="nx">i</span><span class="o">=</span><span class="nx">nt</span><span class="p">;</span><span class="nx">a</span><span class="p">.</span><span class="nx">p</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="o">:+</span><span class="k">new</span> <span class="nb">Date</span><span class="p">};</span><span class="nx">a</span><span class="p">.</span><span class="nx">P</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">u</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">p</span><span class="p">[</span><span class="nx">u</span><span class="p">]</span><span class="o">=</span><span class="k">new</span> <span class="nb">Date</span><span class="o">-</span><span class="nx">a</span><span class="p">.</span><span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]};</span><span class="kd">function</span> <span class="nx">s</span><span class="p">(){</span><span class="nx">a</span><span class="p">.</span><span class="nx">P</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span><span class="nx">f</span><span class="p">[</span><span class="nx">z</span><span class="p">](</span><span class="nx">r</span><span class="p">)}</span><span class="nx">f</span><span class="p">.</span><span class="nx">addEventListener</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">r</span><span class="p">,</span><span class="nx">s</span><span class="p">);</span><span class="kd">var</span> <span class="nx">ld</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">p</span><span class="p">(</span><span class="nx">hd</span><span class="p">){</span><span class="nx">hd</span><span class="o">=</span><span class="s2">&quot;head&quot;</span><span class="p">;</span><span class="k">return</span><span class="p">[</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span><span class="nx">hd</span><span class="p">,</span><span class="s2">&quot;&gt;&lt;/&quot;</span><span class="p">,</span><span class="nx">hd</span><span class="p">,</span><span class="s2">&quot;&gt;&lt;&quot;</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="s1">&#39; onl&#39;</span> <span class="o">+</span> <span class="s1">&#39;oad=&quot;var d=&#39;</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="s2">&quot;;d.getElementsByTagName(&#39;head&#39;)[0].&quot;</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="s2">&quot;(d.&quot;</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="s2">&quot;(&#39;script&#39;)).&quot;</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="s2">&quot;=&#39;&quot;</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">l</span><span class="p">,</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&gt;&lt;/&quot;</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="s2">&quot;&gt;&quot;</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="s2">&quot;body&quot;</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">m</span><span class="p">){</span><span class="k">return</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">ld</span><span class="p">,</span><span class="mi">100</span><span class="p">)}</span><span class="nx">a</span><span class="p">.</span><span class="nx">P</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="s2">&quot;appendChild&quot;</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="s2">&quot;createElement&quot;</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">h</span><span class="p">](</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">v</span><span class="o">=</span><span class="nx">n</span><span class="p">[</span><span class="nx">j</span><span class="p">](</span><span class="nx">d</span><span class="p">[</span><span class="nx">h</span><span class="p">](</span><span class="nx">z</span><span class="p">)),</span><span class="nx">b</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">h</span><span class="p">](</span><span class="s2">&quot;iframe&quot;</span><span class="p">),</span><span class="nx">g</span><span class="o">=</span><span class="s2">&quot;document&quot;</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="s2">&quot;domain&quot;</span><span class="p">,</span><span class="nx">o</span><span class="p">;</span><span class="nx">n</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">;</span><span class="nx">m</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="nx">m</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">).</span><span class="nx">id</span><span class="o">=</span><span class="nx">z</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">frameBorder</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="nx">z</span><span class="o">+</span><span class="s2">&quot;-loader&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="sr">/MSIE[ ]+6/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">)){</span><span class="nx">b</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s2">&quot;javascript:false&quot;</span><span class="p">}</span><span class="nx">b</span><span class="p">.</span><span class="nx">allowTransparency</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">;</span><span class="nx">v</span><span class="p">[</span><span class="nx">j</span><span class="p">](</span><span class="nx">b</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="nx">b</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">[</span><span class="nx">g</span><span class="p">].</span><span class="nx">open</span><span class="p">()}</span><span class="k">catch</span><span class="p">(</span><span class="nx">w</span><span class="p">){</span><span class="nx">c</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="nx">o</span><span class="o">=</span><span class="s2">&quot;javascript:var d=&quot;</span><span class="o">+</span><span class="nx">g</span><span class="o">+</span><span class="s2">&quot;.open();d.domain=&#39;&quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">.</span><span class="nx">domain</span><span class="o">+</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span><span class="nx">b</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">=</span><span class="nx">o</span><span class="o">+</span><span class="s2">&quot;void(0);&quot;</span><span class="p">}</span><span class="k">try</span><span class="p">{</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">[</span><span class="nx">g</span><span class="p">];</span><span class="nx">t</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">p</span><span class="p">());</span><span class="nx">t</span><span class="p">.</span><span class="nx">close</span><span class="p">()}</span><span class="k">catch</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="nx">b</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">=</span><span class="nx">o</span><span class="o">+</span><span class="s1">&#39;d.write(&quot;&#39;</span><span class="o">+</span><span class="nx">p</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;/g</span><span class="p">,</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot;);d.close();&#39;</span><span class="p">}</span><span class="nx">a</span><span class="p">.</span><span class="nx">P</span><span class="p">(</span><span class="mi">2</span><span class="p">)};</span><span class="nx">ld</span><span class="p">()};</span><span class="nx">nt</span><span class="p">()})({</span><span class="nx">loader</span><span class="o">:</span> <span class="s2">&quot;static.olark.com/jsclient/loader0.js&quot;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;olark&quot;</span><span class="p">,</span><span class="nx">methods</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;configure&quot;</span><span class="p">,</span><span class="s2">&quot;extend&quot;</span><span class="p">,</span><span class="s2">&quot;declare&quot;</span><span class="p">,</span><span class="s2">&quot;identify&quot;</span><span class="p">]});</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">olark</span><span class="p">.</span><span class="nx">identify</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">identify</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">traits</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">olark</span><span class="p">(</span><span class="s1">&#39;api.chat.updateVisitorNickname&#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">snippet</span> <span class="o">:</span> <span class="nx">userId</span>
            <span class="p">});</span>
        <span class="p">},</span>

        <span class="nx">track</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">track</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">olark</span><span class="p">(</span><span class="s1">&#39;api.chat.sendNotificationToOperator&#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">body</span> <span class="o">:</span> <span class="s1">&#39;Visitor triggered &quot;&#39;</span><span class="o">+</span><span class="nx">event</span><span class="o">+</span><span class="s1">&#39;&quot;.&#39;</span>
            <span class="p">});</span>
        <span class="p">}</span>

    <span class="p">};</span>


<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 